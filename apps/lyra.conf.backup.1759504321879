# Lyra dev proxy config (generated)
location = /lyra {
  return 301 /lyra/;
}

location /lyra/ {
  proxy_http_version 1.1;
  proxy_set_header Host $host;
  proxy_set_header X-Forwarded-Proto $scheme;
  proxy_set_header X-Forwarded-Host $host;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection "upgrade";
  proxy_set_header ngrok-skip-browser-warning "true";
  proxy_buffering off;
  proxy_read_timeout 300s;
  proxy_send_timeout 300s;
  resolver 127.0.0.11 ipv6=off;
  resolver_timeout 5s;
  set $lyra_upstream lyra:4000;
  proxy_pass http://$lyra_upstream;
}

# Root helpers: allow Next.js asset paths at proxy root
location ^~ /_next/ {
  proxy_http_version 1.1;
  proxy_set_header Host $host;
  proxy_set_header X-Forwarded-Proto $scheme;
  proxy_set_header X-Forwarded-Host $host;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection "upgrade";
  proxy_buffering off;
  resolver 127.0.0.11 ipv6=off;
  resolver_timeout 5s;
  set $lyra_upstream lyra:4000;
  proxy_pass http://$lyra_upstream/_next/;
}
