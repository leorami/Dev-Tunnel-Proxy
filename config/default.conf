# Use Docker's internal DNS resolver
resolver 127.0.0.11 valid=30s;

# Disable strict upstream validation
proxy_connect_timeout 1s;
proxy_send_timeout 1s;
proxy_read_timeout 1s;

server {
  listen 80;
  server_name _;

  # Proxy health
  location = / {
    return 200 'dev-proxy alive';
    add_header Content-Type text/plain;
  }

  # Each app contributes exactly one tiny file here.
  include /etc/nginx/conf.d/apps/*.conf;
}
