# Example: App served under /myapp/ (keep the prefix; no trailing slash on proxy_pass)
# Suitable for frameworks using a basePath (e.g., Next.js only when tunneled).
location /myapp/ {
  proxy_http_version 1.1;

  # Forwarded headers
  proxy_set_header Host $host;
  proxy_set_header X-Forwarded-Proto $scheme;

  # WebSockets / HMR
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection "upgrade";

  # Use variable for dynamic upstream resolution
  set $upstream_sample_app "sample-app:3000";
  proxy_pass http://$upstream_sample_app;
  proxy_read_timeout 300;
  proxy_send_timeout 300;
}
